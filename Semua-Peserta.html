<!DOCTYPE html>
<html style="font-size: 16px;" lang="en"><head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="keywords" content="SEMUA PESERTA">
    <meta name="description" content="">
    <title>Semua Peserta</title>
    <link rel="stylesheet" href="nicepage.css" media="screen">
<link rel="stylesheet" href="Semua-Peserta.css" media="screen">
    <script class="u-script" type="text/javascript" src="jquery.js" defer=""></script>
    <script class="u-script" type="text/javascript" src="nicepage.js" defer=""></script>
    <meta name="generator" content="Nicepage 7.0.3, nicepage.com">
    <link id="u-theme-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,500,500i,600,600i,700,700i,800,800i">
    <link id="u-page-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i|Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i">
    
    
    
    <script type="application/ld+json">{
		"@context": "http://schema.org",
		"@type": "Organization",
		"name": "",
		"logo": "images/LOGO20FINAL11.png",
		"sameAs": [
				"https://www.instagram.com/informershmif/"
		]
}</script>
    <meta name="theme-color" content="#478ac9">
    <meta property="og:title" content="Semua Peserta">
    <meta property="og:type" content="website">
  <meta data-intl-tel-input-cdn-path="intlTelInput/"></head>
  <body data-path-to-root="./" data-include-products="false" class="u-body u-xl-mode" data-lang="en"><header class="u-clearfix u-header u-header" id="sec-fb37"><div class="u-clearfix u-sheet u-sheet-1">
        <a href="#" class="u-image u-logo u-image-1" data-image-width="331" data-image-height="330">
          <img src="images/LOGO20FINAL11.png" class="u-logo-image u-logo-image-1">
        </a>
        <nav class="u-menu u-menu-one-level u-offcanvas u-menu-1">
          <div class="menu-collapse u-custom-font u-font-roboto" style="font-size: 1rem; letter-spacing: 0px; text-transform: uppercase; font-weight: 700;">
            <a class="u-button-style u-custom-left-right-menu-spacing u-custom-padding-bottom u-custom-text-hover-color u-custom-top-bottom-menu-spacing u-hamburger-link u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="#">
              <svg class="u-svg-link" viewBox="0 0 24 24"><use xlink:href="#menu-hamburger"></use></svg>
              <svg class="u-svg-content" version="1.1" id="menu-hamburger" viewBox="0 0 16 16" x="0px" y="0px" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg"><g><rect y="1" width="16" height="2"></rect><rect y="7" width="16" height="2"></rect><rect y="13" width="16" height="2"></rect>
</g></svg>
            </a>
          </div>
          <div class="u-custom-menu u-nav-container">
            <ul class="u-custom-font u-font-roboto u-nav u-unstyled u-nav-1"><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-1-light-2" href="./" style="padding: 10px 20px;">Home</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-1-light-2" href="QR-SCANNER.html" style="padding: 10px 20px;">QR SCANNER</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-1-light-2" href="Semua-Peserta.html" style="padding: 10px 20px;">Semua Peserta</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-1-light-2" href="Belum-Check-in.html" style="padding: 10px 20px;">Belum Check-in</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-1-light-2" href="Sudah-Check-in.html" style="padding: 10px 20px;">Sudah Check-in</a>
</li></ul>
          </div>
          <div class="u-custom-menu u-nav-container-collapse">
            <div class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav">
              <div class="u-inner-container-layout u-sidenav-overflow">
                <div class="u-menu-close"></div>
                <ul class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-2"><li class="u-nav-item"><a class="u-button-style u-nav-link" href="./">Home</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="QR-SCANNER.html">QR SCANNER</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="Semua-Peserta.html">Semua Peserta</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="Belum-Check-in.html">Belum Check-in</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="Sudah-Check-in.html">Sudah Check-in</a>
</li></ul>
              </div>
            </div>
            <div class="u-black u-menu-overlay u-opacity u-opacity-70"></div>
          </div>
        </nav>
      </div></header>
    <section class="u-clearfix u-section-1" id="sec-8962">
      <div class="u-clearfix u-sheet u-sheet-1">
        <h1 class="u-custom-font u-font-montserrat u-text u-text-default u-text-1">SEMUA PESERTA</h1>
        <label for="dateFilter">Select Date:</label>
<input type="date" id="dateFilter" />
<button onclick="exportToExcel()">Export to Excel</button>
<style>
  body {
      font-family: Arial, sans-serif;
      padding: 20px;
  }
  h2 {
      margin-bottom: 10px;
      text-align: center;
  }
  #dateFilter {
      margin-bottom: 10px;
  }
  table {
      width: 100%;
      margin-top: 20px;
      margin-bottom: 20px;
      border-collapse: collapse;
  }
  th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
  }
  th {
      background-color: #f2f2f2;
  }
  tr:nth-child(even) {
      background-color: #f9f9f9;
  }
  tr:hover {
      background-color: #e0e0e0;
  }
  button {
      margin-top: 10px;
      margin-left: 20px;
      padding: 10px 20px;
      background-color: #4CAF50;
      color: white;
      border: none;
      cursor: pointer;
  }
  button:hover {
      background-color: #45a094;
  }
  .u-section-1 {
  padding-bottom: 20px; 
}

</style>
<table id="data-table">
    <thead>
        <tr id="table-header"></tr>
    </thead>
    <tbody></tbody>
</table>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
const SHEET_ID = "1vglTBWikJcY5_kcONo_RHzyVLCZ5G6MfeYwLt9_mCIk"; // Replace with your Google Sheet ID
const SHEET_RANGE = "A1:K57"; // Adjust the range as needed

const API_KEY = "AIzaSyBIU9iDtpqka5SlGkksVE1vewt47rDsXR0"; // Replace with your Google API Key

async function fetchData() {
  const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${SHEET_RANGE}?key=${API_KEY}`;
  const response = await fetch(url);
  const data = await response.json();
  return data.values;
}

function populateTable(data, filterDate = "") {
  const tableBody = document.querySelector("#data-table tbody");
  const tableHeader = document.querySelector("#table-header");
  tableBody.innerHTML = "";
  tableHeader.innerHTML = "";

  if (!data || data.length === 0) {
    console.error("No data fetched from Google Sheets.");
    // Handle the case where no data is available
    return;
  }

  const headers = data[0];

  // Create table headers
  headers.forEach((header) => {
    const th = document.createElement("th");
    th.textContent = header;
    tableHeader.appendChild(th);
  });

  // Iterate through data rows, starting from the second row (index 1)
  for (let i = 1; i < data.length; i++) {
    const row = data[i];

    // Check if row is undefined or empty
    if (!row || row.length === 0) {
      console.warn("Empty row encountered at index:", i);
      continue; // Skip to the next row
    }

    let rowDate = row[0]; // Assuming the timestamp is in the first column

    let parsedDate;
    try {
      parsedDate = new Date(rowDate);
    } catch (error) {
      console.warn("Invalid timestamp encountered in row:", i, error);
      continue; // Skip the row with invalid timestamp
    }

    const formattedDate = parsedDate.toISOString().split('T')[0];

    // Compare the formatted date with the filter date
    if (filterDate && formattedDate !== filterDate) {
      continue; // Skip the row if it doesn't match the filter
    }

    const tr = document.createElement("tr");

    // Populate row cells
    headers.forEach((header, index) => {
      const td = document.createElement("td");
      td.textContent = row[index] !== undefined ? row[index] : "-";
      tr.appendChild(td);
    });

    tableBody.appendChild(tr);
  }
}

// Load data and populate table
async function loadSheetData(filterDate = "") {
  try {
    const data = await fetchData();
    populateTable(data, filterDate);
  } catch (error) {
    console.error("Error fetching data:", error);
  }
}

// Filter data based on selected date
document.getElementById("dateFilter").addEventListener("change", (event) => {
  const selectedDate = event.target.value;
  loadSheetData(selectedDate);
});

// Initialize on window load
window.onload = () => loadSheetData();
</script>
      </div>
    </section>
    
    <footer class="u-clearfix u-footer u-grey-70" id="sec-9b4b"><div class="u-clearfix u-sheet u-sheet-1">
        <div class="data-layout-selected u-clearfix u-expanded-width u-gutter-30 u-layout-wrap u-layout-wrap-1">
          <div class="u-gutter-0 u-layout">
            <div class="u-layout-row">
              <div class="u-align-center-sm u-align-center-xs u-align-left-md u-align-left-xl u-container-style u-layout-cell u-left-cell u-size-20 u-size-30-md u-layout-cell-1">
                <div class="u-container-layout u-valign-middle u-container-layout-1"><!--position-->
                  <div data-position="" class="u-position u-position-1"><!--block-->
                    <div class="u-block">
                      <div class="u-block-container u-clearfix"><!--block_header-->
                        <h5 class="u-block-header u-text u-text-1"><!--block_header_content--> INFORMERS'20<!--/block_header_content--></h5><!--/block_header--><!--block_content-->
                        <div class="u-block-content u-text"><!--block_content_content-->Coding is our bestfriend <!--/block_content_content--></div><!--/block_content-->
                      </div>
                    </div><!--/block-->
                  </div><!--/position-->
                </div>
              </div>
              <div class="u-align-center-sm u-align-right-md u-container-style u-layout-cell u-size-20 u-size-30-md u-layout-cell-2">
                <div class="u-container-layout u-valign-middle u-container-layout-2">
                  <a href="#" class="u-image u-logo u-image-1" data-image-width="331" data-image-height="330">
                    <img src="images/LOGO20FINAL11.png" class="u-logo-image u-logo-image-1">
                  </a>
                </div>
              </div>
              <div class="u-align-center-sm u-align-center-xs u-align-left-md u-align-right-lg u-align-right-xl u-container-style u-layout-cell u-right-cell u-size-20 u-size-30-md u-layout-cell-3">
                <div class="u-container-layout u-valign-middle u-container-layout-3">
                  <div class="u-social-icons u-spacing-10 u-social-icons-1">
                    <a class="u-social-url" title="instagram" target="_blank" href="https://www.instagram.com/informershmif/"><span class="u-icon u-social-icon u-social-instagram u-icon-1"><svg class="u-svg-link" preserveAspectRatio="xMidYMin slice" viewBox="0 0 112 112" style=""><use xlink:href="#svg-a519"></use></svg><svg class="u-svg-content" viewBox="0 0 112 112" x="0" y="0" id="svg-a519"><circle fill="currentColor" cx="56.1" cy="56.1" r="55"></circle><path fill="#FFFFFF" d="M55.9,38.2c-9.9,0-17.9,8-17.9,17.9C38,66,46,74,55.9,74c9.9,0,17.9-8,17.9-17.9C73.8,46.2,65.8,38.2,55.9,38.2
      z M55.9,66.4c-5.7,0-10.3-4.6-10.3-10.3c-0.1-5.7,4.6-10.3,10.3-10.3c5.7,0,10.3,4.6,10.3,10.3C66.2,61.8,61.6,66.4,55.9,66.4z"></path><path fill="#FFFFFF" d="M74.3,33.5c-2.3,0-4.2,1.9-4.2,4.2s1.9,4.2,4.2,4.2s4.2-1.9,4.2-4.2S76.6,33.5,74.3,33.5z"></path><path fill="#FFFFFF" d="M73.1,21.3H38.6c-9.7,0-17.5,7.9-17.5,17.5v34.5c0,9.7,7.9,17.6,17.5,17.6h34.5c9.7,0,17.5-7.9,17.5-17.5V38.8
      C90.6,29.1,82.7,21.3,73.1,21.3z M83,73.3c0,5.5-4.5,9.9-9.9,9.9H38.6c-5.5,0-9.9-4.5-9.9-9.9V38.8c0-5.5,4.5-9.9,9.9-9.9h34.5
      c5.5,0,9.9,4.5,9.9,9.9V73.3z"></path></svg></span>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div></footer>

</body></html>
